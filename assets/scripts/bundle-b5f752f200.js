!function e(t,a,s){function r(l,i){if(!a[l]){if(!t[l]){var n="function"==typeof require&&require;if(!i&&n)return n(l,!0);if(o)return o(l,!0);var u=new Error("Cannot find module '"+l+"'");throw u.code="MODULE_NOT_FOUND",u}var m=a[l]={exports:{}};t[l][0].call(m.exports,function(e){var a=t[l][1][e];return r(a?a:e)},m,m.exports,e,t,a,s)}return a[l].exports}for(var o="function"==typeof require&&require,l=0;l<s.length;l++)r(s[l]);return r}({"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js":[function(e,t,a){"use strict";var s=e("reflux");t.exports=s.createActions({selectedBbox:{},latestImageryLoaded:{},footprintsLoaded:{},setDateFilter:{shouldEmit:function(e){return["all","week","month","year"].indexOf(e)>=0}},setResolutionFilter:{shouldEmit:function(e){return["all","low","medium","high"].indexOf(e)>=0}},setDataTypeFilter:{shouldEmit:function(e){return["all","service"].indexOf(e)>=0}},resultOver:{},resultOut:{},openModal:{},geocoderResult:{},requestMyLocation:{},selectPreview:{},setBaseLayer:{}})},{reflux:"reflux"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/app.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("./modals/message_modal"),i=s(l),n=e("./modals/feedback_modal"),u=s(n),m=e("./header"),d=s(m),c=e("../actions/actions"),p=s(c),f=o["default"].createClass({displayName:"App",propTypes:{params:o["default"].PropTypes.object,location:o["default"].PropTypes.object,children:o["default"].PropTypes.object},componentWillMount:function(){var e=this.props.location.query||{};e.date&&p["default"].setDateFilter(e.date),e.resolution&&p["default"].setResolutionFilter(e.resolution),e.type&&p["default"].setDataTypeFilter(e.type)},render:function(){var e=this.props.params||{},t=this.props.location.query||{};return o["default"].createElement("div",null,o["default"].createElement(d["default"],{params:e,query:t}),o["default"].createElement("main",{className:"page__body",role:"main"},o["default"].createElement("section",{className:"layout layout--app"},o["default"].createElement("header",{className:"layout__header"},o["default"].createElement("div",{className:"inner"},o["default"].createElement("div",{className:"layout__headline"},o["default"].createElement("h1",{className:"layout__title"},"Browse")))),o["default"].createElement("div",{className:"layout__body"},o["default"].createElement("div",{className:"inner"},o["default"].cloneElement(this.props.children,{params:e,query:t}))))),o["default"].createElement("footer",{className:"page__footer",role:"contentinfo"},o["default"].createElement("div",{className:"inner"},o["default"].createElement("p",null,"Made with love by ",o["default"].createElement("a",{href:"https://developmentseed.org",title:"Visit Development Seed website"},"Development Seed")," and ",o["default"].createElement("a",{href:"http://hot.openstreetmap.org/",title:"Visit the Humanitarian OpenStreetMap Team website"},"HOT"),"."))),o["default"].createElement(i["default"],null),o["default"].createElement(u["default"],null))}});t.exports=f},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","./header":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/header.js","./modals/feedback_modal":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/modals/feedback_modal.js","./modals/message_modal":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/modals/message_modal.js",react:"react"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/filters.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-router"),o=e("react"),l=s(o),i=e("reflux"),n=s(i),u=e("oam-design-system"),m=e("../actions/actions"),d=s(m),c=e("../stores/search_query_store"),p=s(c),f=e("../utils/cookie"),h=s(f),y=e("../config.js"),g=s(y),b=l["default"].createClass({displayName:"Filters",propTypes:{query:l["default"].PropTypes.object,params:l["default"].PropTypes.object},mixins:[n["default"].listenTo(p["default"],"onSearchQuery")],getInitialState:function(){return{date:"all",resolution:"all",dataType:"all"}},onSearchQuery:function(e){this.setState(e)},setDate:function(e){d["default"].setDateFilter(e.key),this._updateUrl("date",e.key)},setResolution:function(e){d["default"].setResolutionFilter(e.key),this._updateUrl("resolution",e.key)},setDataType:function(e){d["default"].setDataTypeFilter(e.key),this._updateUrl("type",e.key)},_updateUrl:function(e,t){var a=this.props.query;"all"===t?delete a[e]:a[e]=t;var s=this.props.params.map;if(!s){var o=h["default"].read("oam-browser:map-view");s="undefined"!==o?h["default"].read("oam-browser:map-view"):g["default"].map.initialView.concat(g["default"].map.initialZoom).join(",")}r.hashHistory.push({pathname:s,query:a})},render:function(){function e(e,t,a){var s=this.state[e]===a.key?"drop__menu-item--active":"",r=t.bind(this,a);return l["default"].createElement("li",{key:e+"-filter-"+a.key},l["default"].createElement("a",{onClick:r,title:a.title,className:"drop__menu-item "+s},a.title))}var t=[{key:"all",title:"All"},{key:"week",title:"Last week"},{key:"month",title:"Last month"},{key:"year",title:"Last year"}].map(e.bind(this,"date",this.setDate)),a=[{key:"all",title:"All"},{key:"low",title:"Low"},{key:"medium",title:"Medium"},{key:"high",title:"High"}].map(e.bind(this,"resolution",this.setResolution)),s=[{key:"all",title:"All Images"},{key:"service",title:"Image + Map Layer"}].map(e.bind(this,"dataType",this.setDataType));return l["default"].createElement(u.Dropdown,{className:"drop__content--filters",triggerElement:"a",triggerClassName:"button-filters",triggerActiveClassName:"button--active",triggerTitle:"Settings",triggerText:"Settings",direction:"down",alignment:"center"},l["default"].createElement("h6",{className:"drop__title"},"Time"),l["default"].createElement("ul",{className:"drop__menu drop__menu--select",role:"menu"},t),l["default"].createElement("h6",{className:"drop__title"},"Resolution"),l["default"].createElement("ul",{className:"drop__menu drop__menu--select",role:"menu"},a),l["default"].createElement("h6",{className:"drop__title"},"Data Type"),l["default"].createElement("ul",{className:"drop__menu drop__menu--select",role:"menu"},s))}});t.exports=b},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../config.js":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js","../stores/search_query_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/search_query_store.js","../utils/cookie":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/cookie.js","oam-design-system":"oam-design-system",react:"react","react-router":"react-router",reflux:"reflux"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/header.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("react-router"),i=e("react-keybinding"),n=s(i),u=e("jquery"),m=s(u),d=e("turf-centroid"),c=s(d),p=e("oam-design-system"),f=e("../actions/actions"),h=s(f),y=e("./filters"),g=s(y),b=e("../utils/utils"),v=s(b),_=e("../config"),w=s(_),E=e("../stores/map_store"),k=s(E),S=e("./map-layers"),q=s(S),x=o["default"].createClass({displayName:"Header",propTypes:{query:o["default"].PropTypes.object,params:o["default"].PropTypes.object},mixins:[n["default"]],keybindings:{i:function(){h["default"].openModal("info")},s:function(){var e=this;setTimeout(function(){return e.refs.geocoder.focus()},10)}},getInitialState:function(){return{oamHealth:null}},fetchOAMHealth:function(){var e=this;m["default"].get(w["default"].oamStatus).success(function(t){e.setState({oamHealth:t.health})})},feedbackClickHandler:function(e){e.preventDefault(),h["default"].openModal("feedback")},onGeocoderSearch:function(e){e.preventDefault();var t=this.refs.geocoder.value;v["default"].queryGeocoder(t,function(e){return e?void h["default"].geocoderResult(e):void console.warn("geocoder -- no result was found")})},onMyLocationClick:function(e){e.preventDefault(),h["default"].requestMyLocation()},componentDidMount:function(){this.fetchOAMHealth()},onBrowseLatestClick:function(e){e.preventDefault();var t=10,a=k["default"].getLatestImagery(),s={type:"Feature",geometry:a.geojson},r=(0,c["default"])(s).geometry.coordinates,o=v["default"].quadkeyFromCoords(r[0],r[1],t),i=r[0]+","+r[1]+","+t;l.hashHistory.push("/"+i+"/"+o+"/"+a._id)},render:function(){var e="drop__menu-item status-item ";switch(this.state.oamHealth){case"green":e+="status-item--up";break;case"yellow":e+="status-item--meh";break;case"red":e+="status-item--down";break;default:e+="status-item--unknown"}return o["default"].createElement("header",{className:"page__header",role:"banner"},o["default"].createElement("div",{className:"inner"},o["default"].createElement("div",{className:"page__headline"},o["default"].createElement("h1",{className:"page__title"},o["default"].createElement("span",{className:"mast-logo mast-logo--h"},o["default"].createElement("a",{href:"https://openaerialmap.org/",title:"Visit homepage"},o["default"].createElement("img",{className:"mast-logo__image",src:"assets/graphics/layout/oam-logo-h-pos.svg",width:"832",height:"160",alt:"OpenAerialMap logo"}),o["default"].createElement("strong",{className:"mast-logo__text"},"OpenAerialMap")),o["default"].createElement("small",{className:"mast-logo__label"},"Browser")))),o["default"].createElement("nav",{className:"page__prime-nav",role:"navigation"},o["default"].createElement("div",{className:"nav-block-prime"},o["default"].createElement("form",{className:"form global-search",onSubmit:this.onGeocoderSearch},o["default"].createElement("div",{className:"form__group"},o["default"].createElement("label",{className:"form__label",htmlFor:"global-search__input"},"Search"),o["default"].createElement("div",{className:"form__input-group"},o["default"].createElement("input",{className:"form__control form__control--medium",id:"global-search__input",type:"search",placeholder:"Search location",ref:"geocoder"}),navigator.geolocation?o["default"].createElement("a",{href:"#",title:"Take me to my location",className:"global-search__button-location",onClick:this.onMyLocationClick},o["default"].createElement("span",null,"My location")):null,o["default"].createElement("span",{className:"form__input-group-button"},o["default"].createElement("button",{className:"global-search__button-go",type:"submit"},o["default"].createElement("span",null,"Search")))))),o["default"].createElement("ul",{className:"app-menu"},o["default"].createElement("li",null,o["default"].createElement(g["default"],{params:this.props.params,query:this.props.query})),o["default"].createElement("li",null,o["default"].createElement("a",{href:"#",onClick:this.onBrowseLatestClick,className:"button-latest",title:"Go to the latest imagery"},o["default"].createElement("span",null,"Latest imagery"))),o["default"].createElement("li",{className:"map-layers"},o["default"].createElement(q["default"],null)))),o["default"].createElement("div",{className:"nav-block-sec"},o["default"].createElement("ul",{className:"meta-menu"},o["default"].createElement("li",null,o["default"].createElement("a",{href:"https://upload.openaerialmap.org/",className:"button-upload",title:"Go to OAM Uploader"},o["default"].createElement("span",null,"Upload"))),o["default"].createElement("li",null,o["default"].createElement(p.Dropdown,{triggerElement:"a",triggerClassName:"button-info",triggerActiveClassName:"button--active",triggerTitle:"Info",triggerText:"Info",direction:"down",alignment:"right"},o["default"].createElement("ul",{className:"drop__menu info-menu",role:"menu"},o["default"].createElement("li",null,o["default"].createElement("a",{className:"drop__menu-item",href:"http://openaerialmap.org/about",title:"Learn more","data-hook":"dropdown:close"},o["default"].createElement("span",null,"About"))),o["default"].createElement("li",null,o["default"].createElement("a",{className:"drop__menu-item",href:"http://docs.openaerialmap.org/browser/getting-started/",title:"Go to User Guide"},o["default"].createElement("span",null,"Help"))),o["default"].createElement("li",null,o["default"].createElement("a",{className:"drop__menu-item",href:"#modal-feedback",title:"Leave feedback","data-hook":"dropdown:close",onClick:this.feedbackClickHandler},o["default"].createElement("span",null,"Feedback"))),o["default"].createElement("li",null,o["default"].createElement("a",{className:"drop__menu-item",href:"mailto:info@openaerialmap.org",title:"Get in touch"},o["default"].createElement("span",null,"Contact")," ",o["default"].createElement("small",null,"info@openaerialmap.org")))),o["default"].createElement("ul",{className:"drop__menu info-menu",role:"menu"},o["default"].createElement("li",null,o["default"].createElement("a",{href:"https://status.openaerialmap.org/",className:e,title:"Go to OAM Status"},o["default"].createElement("span",null,"Status")))))))))))}});t.exports=x},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../config":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js","../stores/map_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/map_store.js","../utils/utils":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js","./filters":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/filters.js","./map-layers":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/map-layers.js",jquery:"jquery","oam-design-system":"oam-design-system",react:"react","react-keybinding":"react-keybinding","react-router":"react-router","turf-centroid":"turf-centroid"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/home.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("reflux"),i=s(l),n=e("lodash"),u=s(n),m=e("./map"),d=s(m),c=e("./minimap"),p=s(c),f=e("./results_pane"),h=s(f),y=e("../stores/map_store"),g=s(y),b=e("../stores/search_query_store"),v=s(b),_=e("../utils/cookie"),w=s(_),E=e("../utils/utils"),k=s(E),S=e("../actions/actions"),q=s(S),x=e("../config.js"),N=s(x),j=o["default"].createClass({displayName:"Home",propTypes:{params:o["default"].PropTypes.object,query:o["default"].PropTypes.object},mixins:[i["default"].listenTo(v["default"],"onSearchQueryChanged"),i["default"].listenTo(g["default"],"onMapStoreData")],getInitialState:function(){return{results:[],loading:!0,map:{view:null},selectedSquareQuadkey:null,selectedItemId:null,filterParams:v["default"].getParameters()}},onMapStoreData:function(e){var t=u["default"].cloneDeep(this.state);t.results=g["default"].getResults(),t.loading="squareData"!==e&&g["default"].footprintsWereFecthed(),this.setState(t)},onSearchQueryChanged:function(e){this.setState({filterParams:e})},componentWillMount:function(){var e=u["default"].cloneDeep(this.state);e.map.view=this.getMapViewOrDefault(this.props.params.map),e.selectedSquareQuadkey=this.props.params.square,e.selectedItemId=this.props.params.item_id,this.setState(e)},componentWillReceiveProps:function(e){var t=u["default"].cloneDeep(this.state),a=this.getMapViewOrDefault(e.params.map);if(this.getMapViewOrDefault(this.props.params.map)!==a&&(t.map.view=a,w["default"].create("oam-browser:map-view",t.map.view)),this.props.params.square!==e.params.square&&(t.selectedSquareQuadkey=e.params.square),this.props.params.square&&!e.params.square&&(t.results=[]),this.props.params.square!==e.params.square&&e.params.square){var s=k["default"].tileBboxFromQuadkey(e.params.square);t.loading=!0,q["default"].selectedBbox(s)}this.props.params.item_id!==e.params.item_id&&(t.selectedItemId=e.params.item_id),this.setState(t)},componentDidMount:function(){if(this.state.selectedSquareQuadkey){var e=k["default"].tileBboxFromQuadkey(this.state.selectedSquareQuadkey);q["default"].selectedBbox(e)}},render:function(){var e=u["default"].find(this.state.results,{_id:this.state.selectedItemId});return o["default"].createElement("div",null,this.state.loading?o["default"].createElement("p",{className:"loading revealed"},"Loading"):null,o["default"].createElement(d["default"],{query:this.props.query,mapView:this.state.map.view,selectedSquareQuadkey:this.state.selectedSquareQuadkey,selectedItemId:this.state.selectedItemId,selectedItem:e,filterParams:this.state.filterParams}),o["default"].createElement(p["default"],{query:this.props.query,selectedSquare:this.props.params.square,selectedSquareQuadkey:this.state.selectedSquareQuadkey,selectedItemId:this.state.selectedItemId,mapView:this.state.map.view}),o["default"].createElement(h["default"],{query:this.props.query,mapView:this.state.map.view,results:this.state.results,selectedItemId:this.state.selectedItemId,selectedSquareQuadkey:this.state.selectedSquareQuadkey}))},getMapViewOrDefault:function(e){if(!e){var t=w["default"].read("oam-browser:map-view");"undefined"!==t&&null!==t?e=w["default"].read("oam-browser:map-view"):(e=N["default"].map.initialView.concat(N["default"].map.initialZoom).join(","),w["default"].create("oam-browser:map-view",e))}return e}});t.exports=j},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../config.js":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js","../stores/map_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/map_store.js","../stores/search_query_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/search_query_store.js","../utils/cookie":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/cookie.js","../utils/utils":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js","./map":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/map.js","./minimap":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/minimap.js","./results_pane":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/results_pane.js",lodash:"lodash",react:"react",reflux:"reflux"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/map-layers.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("oam-design-system"),i=e("../utils/map-layers"),n=s(i),u=e("../actions/actions"),m=s(u),d=e("../stores/map_store"),c=s(d),p=o["default"].createClass({displayName:"MapLayers",getInitialState:function(){return{selectedLayer:c["default"].getBaseLayer()}},onLayerSelect:function(e,t){t.preventDefault(),m["default"].setBaseLayer(e),this.setState({selectedLayer:e})},render:function(){var e=this;return o["default"].createElement(l.Dropdown,{triggerElement:"a",triggerClassName:"button-layers",triggerActiveClassName:"button--active",triggerTitle:"Choose map layer",triggerText:"Choose map layer",direction:"left",className:"drop__content--maplayers",alignment:"middle"},o["default"].createElement("ul",{className:"drop__menu drop__menu--select map-layers-list"},n["default"].map(function(t){return o["default"].createElement("li",{key:t.id},o["default"].createElement(f,{selectedLayer:e.state.selectedLayer,layer:t,onLayerSelect:e.onLayerSelect}))})))}});t.exports=p;var f=o["default"].createClass({displayName:"MapLayerItem",propTypes:{selectedLayer:o["default"].PropTypes.object,layer:o["default"].PropTypes.object,onLayerSelect:o["default"].PropTypes.func},map:null,componentDidMount:function(){this.map=L.mapbox.map(this.refs.map,null,{zoomControl:null}),this.map.addLayer(L.tileLayer(this.props.layer.url)).setView([9,0],0),this.map.dragging.disable(),this.map.touchZoom.disable(),this.map.doubleClickZoom.disable(),this.map.scrollWheelZoom.disable(),this.map.keyboard.disable(),this.map.tap&&this.map.tap.disable()},componentWillUnmount:function(){this.map.remove()},render:function(){var e="drop__menu-item";return e+=this.props.selectedLayer.id===this.props.layer.id?" drop__menu-item--active":"",o["default"].createElement("a",{href:"#",className:e,onClick:this.props.onLayerSelect.bind(null,this.props.layer),"data-hook":"dropdown:close"},o["default"].createElement("div",{className:"map-layers-list__map",ref:"map"}),o["default"].createElement("span",{className:"map-layers-list__text"},this.props.layer.name))}})},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../stores/map_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/map_store.js","../utils/map-layers":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/map-layers.js","oam-design-system":"oam-design-system",react:"react"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/map.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-router"),o=e("react"),l=s(o),i=e("reflux"),n=s(i),u=e("lodash"),m=s(u),d=e("tilebelt"),c=s(d),p=e("turf-centroid"),f=s(p),h=e("turf-inside"),y=s(h),g=e("turf-overlaps"),b=s(g),v=e("../actions/actions"),_=s(v),w=e("../config.js"),E=s(w),k=e("../utils/utils"),S=s(k),q=e("../stores/map_store"),x=s(q),N=e("../utils/ds_zoom"),j=s(N);e("mapbox.js"),L.mapbox.accessToken=E["default"].map.mapbox.accessToken;var T=l["default"].createClass({displayName:"Map",propTypes:{query:l["default"].PropTypes.object,mapView:l["default"].PropTypes.string,selectedSquareQuadkey:l["default"].PropTypes.string,selectedItemId:l["default"].PropTypes.string,selectedItem:l["default"].PropTypes.object,filterParams:l["default"].PropTypes.object},mixins:[n["default"].listenTo(_["default"].resultOver,"onResultOver"),n["default"].listenTo(_["default"].resultOut,"onResultOut"),n["default"].listenTo(_["default"].selectPreview,"onSelectPreview"),n["default"].listenTo(_["default"].geocoderResult,"onGeocoderResult"),n["default"].listenTo(_["default"].requestMyLocation,"onRequestMyLocation"),n["default"].listenTo(_["default"].setBaseLayer,"onChangeBaseLayer")],map:null,mapGridLayer:null,mapSelectedSquareLayer:null,mapOverFootprintLayer:null,mapOverImageLayer:null,requireMapViewUpdate:!0,requireSelectedItemUpdate:!0,disableSelectedSquare:!1,baseLayer:null,onSelectPreview:function(e){this.updateSelectedItemImageFootprint(e)},componentWillReceiveProps:function(e){this.requireMapViewUpdate=this.props.mapView!==e.mapView,this.requireSelectedItemUpdate=m["default"].get(this.props.selectedItem,"_id",null)!==m["default"].get(e.selectedItem,"_id",null)},componentDidMount:function(){this.map=L.mapbox.map(this.refs.mapContainer,null,{zoomControl:!1,minZoom:E["default"].map.minZoom,maxZoom:E["default"].map.maxZoom,maxBounds:L.latLngBounds([-90,-210],[90,210]),attributionControl:!1}),this.baseLayer=L.tileLayer(x["default"].getBaseLayer().url),this.map.addLayer(this.baseLayer),this.refs.mapContainer.classList.add("base-layer--"+x["default"].getBaseLayer().id);var e=L.control.attribution().addTo(this.map);e.addAttribution('© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> | <a href="#" data-hook="map:issue">Report an issue with this map</a>');var t=this.refs.mapContainer.querySelector('[data-hook="map:issue"]');t.addEventListener("click",this.onMapIssueReport);var a=new j["default"]({position:"bottomleft",containerClasses:"zoom-controls",zoomInClasses:"button-zoom button-zoom--in",zoomOutClasses:"button-zoom button-zoom--out"});this.map.addControl(a),this.mapGridLayer=L.geoJson(null,{style:L.mapbox.simplestyle.style}).addTo(this.map),this.mapOverFootprintLayer=L.geoJson(null,{style:L.mapbox.simplestyle.style}).addTo(this.map),this.mapSelectedSquareLayer=L.geoJson(null).addTo(this.map),this.mapGridLayer.on("mouseover",this.onGridSqrOver),this.mapGridLayer.on("mouseout",this.onGridSqrOut),this.mapGridLayer.on("click",this.onGridSqrClick);var s=this.stringToMapView(this.props.mapView),r=[s.lat,s.lng],o=s.zoom;this.map.setView(r,o),this.map.on("moveend",this.onMapMoveend),this.updateGrid(),this.updateSelectedSquare()},componentDidUpdate:function(e,t){if(this.requireMapViewUpdate){var a=this.stringToMapView(this.props.mapView);this.map.setView([a.lat,a.lng],a.zoom)}this.updateGrid(),this.updateSelectedSquare(),this.requireSelectedItemUpdate&&this.updateSelectedItemImageFootprint({type:"thumbnail"})},componentWillUnmount:function(){var e=this.refs.mapContainer.querySelector('[data-hook="map:issue"]');e.removeEventListener("click",this.onMapIssueReport)},render:function(){return l["default"].createElement("div",null,l["default"].createElement("div",{id:"map",ref:"mapContainer"}))},onMapIssueReport:function(e){e.preventDefault(),_["default"].openModal("feedback")},onMapMoveend:function(e){var t=this.mapViewToString();this.props.selectedSquareQuadkey&&(t+="/"+this.props.selectedSquareQuadkey),this.props.selectedItemId&&(t+="/"+this.props.selectedItemId),r.hashHistory.replace({pathname:t,query:this.props.query})},onGridSqrOver:function(e){if(!this.getSqrQuadKey()&&e.layer.feature.properties.count>0){L.DomUtil.addClass(e.layer._path,"gs-highlight");var t=(0,f["default"])(e.layer.feature).geometry.coordinates;e.layer.openPopup([t[1],t[0]])}},onGridSqrOut:function(e){L.DomUtil.removeClass(e.layer._path,"gs-highlight"),e.layer.closePopup()},onGridSqrClick:function(e){if(e.layer.closePopup(),this.props.selectedSquareQuadkey)r.hashHistory.push({pathname:"/"+this.props.mapView,query:this.props.query});else if(e.layer.feature.properties.count){var t=e.layer.feature.properties._quadKey,a=Math.round(this.map.getZoom()),s=(0,f["default"])(e.layer.feature).geometry.coordinates,o=S["default"].getMapViewString(s[0],s[1],a);r.hashHistory.push({pathname:"/"+o+"/"+t,query:this.props.query})}},onGeocoderResult:function(e){e&&(this.map.fitBounds(e),r.hashHistory.push({pathname:"/"+this.mapViewToString(),query:this.props.query}))},onChangeBaseLayer:function(){var e=x["default"].getBaseLayer();this.refs.mapContainer.className=this.refs.mapContainer.className.replace(/\bbase-layer--\S*/,""),this.refs.mapContainer.classList.add("base-layer--"+e.id),this.baseLayer&&this.map.removeLayer(this.baseLayer),this.baseLayer=L.tileLayer(e.url),this.map.addLayer(this.baseLayer)},onRequestMyLocation:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){var a=t.coords,s=a.longitude,o=a.latitude,l=S["default"].getMapViewString(s,o,15);r.hashHistory.push({pathname:"/"+l,query:e.props.query})},function(e){console.warn("my location error",e)})},onResultOver:function(e){var t=S["default"].getPolygonFeature(e.geojson.coordinates);this.mapOverFootprintLayer.clearLayers().addData(t),this.mapOverFootprintLayer.eachLayer(function(e){L.DomUtil.addClass(e._path,"g-footprint")})},onResultOut:function(){this.mapOverFootprintLayer.clearLayers()},updateGrid:function(){var e=this;this.mapGridLayer.clearLayers();var t=this.map.getBounds().toBBoxString().split(",").map(Number),a=this.computeGrid(this.map.getZoom(),t);a.features.forEach(function(t){var a=(0,f["default"])(t),s=x["default"].getFootprintsInSquare(t);s=s.filter(function(t){var a=e.props.filterParams,s=t.feature.properties;if("all"!==a.dataType&&!s.tms)return!1;switch(a.resolution){case"low":if(s.gsd<5)return!1;break;case"medium":if(s.gsd>=5||s.gsd<1)return!1;break;case"high":if(s.gsd>=1)return!1}if("all"!==a.date){var r=new Date;if("week"===a.date?r.setDate(r.getDate()-7):"month"===a.date?r.setMonth(r.getMonth()-1):"year"===a.date&&r.setFullYear(r.getFullYear()-1),new Date(s.acquisition_end).getTime()<r.getTime())return!1}return!0}).filter(function(e){var s=e.feature,r=(0,f["default"])(s);return(0,y["default"])(a,s)||(0,y["default"])(r,t)||(0,b["default"])(s,t)}),t.properties.count=s.length}),this.mapGridLayer.addData(a),this.mapGridLayer.eachLayer(function(t){var a=["gs"];e.getSqrQuadKey()?a.push("gs-inactive"):t.feature.properties.count>=50?a.push("gs-density-high"):t.feature.properties.count>=20?a.push("gs-density-medhigh"):t.feature.properties.count>=5?a.push("gs-density-med"):t.feature.properties.count>0&&a.push("gs-density-low"),L.DomUtil.addClass(t._path,a.join(" "));var s=L.popup({autoPan:!1,closeButton:!1,offset:L.point(0,10),className:"gs-tooltip-count"}).setContent(t.feature.properties.count.toString());t.bindPopup(s)})},updateSelectedSquare:function(){if(this.mapSelectedSquareLayer.clearLayers(),this.getSqrQuadKey()&&!this.disableSelectedSquare){var e=this.getSqrQuadKey(),t=S["default"].coordsFromQuadkey(e),a=S["default"].getPolygonFeature(t);this.mapSelectedSquareLayer.addData(a).eachLayer(function(e){L.DomUtil.addClass(e._path,"gs-active gs")})}},updateSelectedItemImageFootprint:function(e){if(this.disableSelectedSquare=!1,this.map.hasLayer(this.mapOverImageLayer)&&(this.map.removeLayer(this.mapOverImageLayer),this.mapOverImageLayer=null),this.props.selectedItem){var t=this.props.selectedItem;if("tms"===e.type){var a=void 0===e.index?t.properties.tms:t.custom_tms[e.index];a=a.replace("{zoom}","{z}"),this.mapOverImageLayer=L.tileLayer(a),this.disableSelectedSquare=!0}else if("thumbnail"===e.type){var s=[[t.bbox[1],t.bbox[0]],[t.bbox[3],t.bbox[2]]];this.mapOverImageLayer=L.imageOverlay(t.properties.thumbnail,s)}this.mapOverImageLayer&&this.map.addLayer(this.mapOverImageLayer)}this.updateSelectedSquare()},getSqrQuadKey:function(){return this.props.selectedSquareQuadkey},computeGrid:function(e,t){e+=2;for(var a=c["default"].pointToTile(t[0],t[1],e),s=c["default"].pointToTile(t[2],t[3],e),r=[],o=a[0];o<=s[0];o++)for(var l=a[1];l>=s[1];l--){var i=[o,l,e],n={type:"Feature",properties:{_quadKey:c["default"].tileToQuadkey(i),id:r.length,tile:i.join("/")},geometry:c["default"].tileToGeoJSON(i)};r.push(n)}return{type:"FeatureCollection",features:r}},mapViewToString:function(){var e=this.map.getCenter(),t=Math.round(this.map.getZoom());return S["default"].getMapViewString(e.lng,e.lat,t)},stringToMapView:function(e){var t=e.split(",");return{lng:t[0],lat:t[1],zoom:t[2]}}});t.exports=T},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../config.js":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js","../stores/map_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/map_store.js","../utils/ds_zoom":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/ds_zoom.js","../utils/utils":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js",lodash:"lodash","mapbox.js":"mapbox.js",react:"react","react-router":"react-router",reflux:"reflux",tilebelt:"tilebelt","turf-centroid":"turf-centroid","turf-inside":"turf-inside","turf-overlaps":"turf-overlaps"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/minimap.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-router"),o=e("react"),l=s(o),i=e("../utils/utils"),n=s(i),u=e("../utils/map-layers"),m=s(u);e("mapbox.js");var d=l["default"].createClass({displayName:"MiniMap",propTypes:{query:l["default"].PropTypes.object,mapView:l["default"].PropTypes.string,selectedSquare:l["default"].PropTypes.string,selectedSquareQuadkey:l["default"].PropTypes.string,selectedItemId:l["default"].PropTypes.string},map:null,targetLines:null,shouldComponentUpdate:function(e,t){return e.selectedSquare!==this.props.selectedSquare},componentDidMount:function(){this.map=L.mapbox.map(this.refs.mapContainer,null,{center:[0,0],zoomControl:!1,attributionControl:!1,dragging:!1,touchZoom:!1,scrollWheelZoom:!1,doubleClickZoom:!1,boxZoom:!1,maxBounds:L.latLngBounds([-90,-180],[90,180])}).fitBounds(L.latLngBounds([-90,-180],[90,180])),this.map.addLayer(L.tileLayer(m["default"][0].url)),this.targetLines=L.multiPolyline([],{clickable:!1,color:"#1f3b45",weight:.5}).addTo(this.map),this.map.on("click",this.onMapClick),this.setCrosshair()},componentDidUpdate:function(){this.setCrosshair()},render:function(){return l["default"].createElement("div",{
id:"minimap",ref:"mapContainer"})},onMapClick:function(e){var t=this.props.mapView.split(",")[2],a=n["default"].getMapViewString(e.latlng.lng,e.latlng.lat,t);this.props.selectedSquareQuadkey&&(a+="/"+this.props.selectedSquareQuadkey),this.props.selectedItemId&&(a+="/"+this.props.selectedItemId),r.hashHistory.push({pathname:a,query:this.props.query})},setCrosshair:function(){if(this.props.selectedSquare){var e=n["default"].tileCenterFromQuadkey(this.props.selectedSquare).geometry.coordinates;this.targetLines.setLatLngs([[[-90,e[0]],[90,e[0]]],[[e[1],-220],[e[1],220]]])}else this.targetLines.clearLayers()}});t.exports=d},{"../utils/map-layers":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/map-layers.js","../utils/utils":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js","mapbox.js":"mapbox.js",react:"react","react-router":"react-router"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/modals/feedback_modal.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("reflux"),i=s(l),n=e("react-keybinding"),u=s(n),m=e("form-serialize"),d=s(m),c=e("jquery"),p=s(c),f=e("lodash"),h=s(f),y=e("oam-design-system"),g=s(y),b=e("../../actions/actions"),v=s(b),_=g["default"].Modal,w=_.Modal,E=_.ModalHeader,k=_.ModalBody,S=o["default"].createClass({displayName:"FeedbackModal",propTypes:{revealed:o["default"].PropTypes.bool},mixins:[i["default"].listenTo(v["default"].openModal,"onOpenModal"),u["default"]],keybindings:{esc:function(){this.closeModal()}},getInitialState:function(){return{revealed:!1,errors:{name:"",email:"",subject:"",message:""},lockSubmit:!1}},onOpenModal:function(e){return"feedback"===e&&this.openModal()},closeModal:function(){this.setState({revealed:!1,errors:{name:"",email:"",subject:"",message:""}})},openModal:function(){this.setState({revealed:!0})},onSubmit:function(e){var t=this;e.preventDefault();var a=this.refs.feedbackForm,s=(0,d["default"])(a,{hash:!0}),r=!0,o={name:"",email:"",subject:"",message:""};s.name&&""!==h["default"].trim(s.name)||(r=!1,o.name="Please provide a valid name."),s.email&&s.email.indexOf("@")===-1&&(r=!1,o.email="Please provide a valid email."),s.subject&&"--"!==s.subject||(r=!1,o.subject="Please select a subject."),s.message&&""!==h["default"].trim(s.message)||(r=!1,o.message="Please provide some feedback."),this.setState({errors:o}),r&&(s.path=window.location.href,console.log("serial",s),this.setState({lockSubmit:!0}),p["default"].post("https://docs.google.com/a/developmentseed.org/forms/d/1VOcERexikGP5N6xkjPDgUuDLUcS_Ktxj_ALNokNuttc/formResponse",{"entry.1992005100":s.name,"entry.1437255376":s.email,"entry.1013721428":s.subject,"entry.212244570":s.message,"entry.1747851236":s.path}).always(function(){a.reset(),t.setState({lockSubmit:!1}),t.closeModal()}))},render:function(){return o["default"].createElement(w,{id:"modal-about",className:"modal--large",onCloseClick:this.closeModal,revealed:this.state.revealed},o["default"].createElement(E,null,o["default"].createElement("div",{className:"modal__headline"},o["default"].createElement("h1",{className:"modal__title"},"Feedback"),o["default"].createElement("p",{className:"modal__subtitle"},"Your feedback helps us build a better system"))),o["default"].createElement(k,null,o["default"].createElement("form",{className:"form-horizontal",ref:"feedbackForm"},o["default"].createElement("div",{className:"form__group"},o["default"].createElement("label",{htmlFor:"name",className:"form__label"},"Name"),o["default"].createElement("div",{className:"form-control-set"},o["default"].createElement("input",{id:"name",name:"name",className:"form__control form__control--medium",type:"text",placeholder:"Bruce Wayne"}),this.state.errors.name?o["default"].createElement("p",{className:"message message--alert"},this.state.errors.name):null)),o["default"].createElement("div",{className:"form__group"},o["default"].createElement("label",{htmlFor:"email",className:"form__label"},"Email"),o["default"].createElement("div",{className:"form-control-set"},o["default"].createElement("input",{id:"email",name:"email",className:"form__control form__control--medium input",type:"email",placeholder:"bruce@wayne.co"}),o["default"].createElement("p",{className:"form__help"},"Email is optional, but provide one if you want followup."),this.state.errors.email?o["default"].createElement("p",{className:"message message--alert"},this.state.errors.email):null)),o["default"].createElement("div",{className:"form__group"},o["default"].createElement("label",{htmlFor:"email",className:"form__label"},"Subject"),o["default"].createElement("div",{className:"form-control-set"},o["default"].createElement("select",{name:"subject",id:"subject",className:"form__control form__control--medium"},o["default"].createElement("option",{value:"--"},"Subject"),o["default"].createElement("option",{value:"report"},"Report a technical issue"),o["default"].createElement("option",{value:"opinion"},"Let us know what you think"),o["default"].createElement("option",{value:"contact"},"Get in touch with OAM team"),o["default"].createElement("option",{value:"other"},"Everything else")),this.state.errors.subject?o["default"].createElement("p",{className:"message message--alert"},this.state.errors.subject):null)),o["default"].createElement("div",{className:"form__group"},o["default"].createElement("label",{htmlFor:"message",className:"form__label"},"Feedback"),o["default"].createElement("div",{className:"form-control-set"},o["default"].createElement("textarea",{name:"message",id:"message",rows:"5",className:"form__control",placeholder:"Leave a message"}),this.state.errors.message?o["default"].createElement("p",{className:"message message--alert"},this.state.errors.message):null)),o["default"].createElement("div",{className:"form__note"},o["default"].createElement("p",null,"When submitting the form, your current url and other necessary information will be collected.")),o["default"].createElement("div",{className:"form__actions"},o["default"].createElement("button",{className:"button button--base button--large"+(this.state.lockSubmit?" disabled":""),type:"submit",onClick:this.onSubmit},o["default"].createElement("span",null,"Submit"))))))}});t.exports=S},{"../../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","form-serialize":"form-serialize",jquery:"jquery",lodash:"lodash","oam-design-system":"oam-design-system",react:"react","react-keybinding":"react-keybinding",reflux:"reflux"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/modals/message_modal.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("reflux"),i=s(l),n=e("react-keybinding"),u=s(n),m=e("oam-design-system"),d=s(m),c=e("../../actions/actions"),p=s(c),f=d["default"].Modal,h=f.Modal,y=f.ModalHeader,g=f.ModalBody,b=o["default"].createClass({displayName:"MessageModal",mixins:[i["default"].listenTo(p["default"].openModal,"onOpenModal"),u["default"]],keybindings:{esc:function(){this.closeModal()}},getInitialState:function(){return{title:"Message",message:"",revealed:!1}},onOpenModal:function(e,t){"message"===e&&t&&(this.setState(t),this.openModal())},closeModal:function(){this.setState({revealed:!1})},openModal:function(){this.setState({revealed:!0})},render:function(){return o["default"].createElement(h,{id:"modal-message",className:"modal--large",onCloseClick:this.closeModal,revealed:this.state.revealed},o["default"].createElement(y,null,o["default"].createElement("div",{className:"modal__headline"},o["default"].createElement("h1",{className:"modal__title"},this.state.title))),o["default"].createElement(g,null,o["default"].createElement("div",{className:"message"},this.state.message)))}});t.exports=b},{"../../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","oam-design-system":"oam-design-system",react:"react","react-keybinding":"react-keybinding",reflux:"reflux"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/results_item.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-router"),o=e("react"),l=s(o),i=e("querystring"),n=s(i),u=e("jquery"),m=s(u),d=e("turf-centroid"),c=s(d),p=e("react-keybinding"),f=s(p),h=e("oam-design-system"),y=e("pretty-bytes"),g=s(y),b=e("../actions/actions"),v=s(b),_=e("./shared/zc_button"),w=s(_),E=e("../utils/utils"),k=s(E),S=l["default"].createClass({displayName:"ResultsItem",propTypes:{query:l["default"].PropTypes.object,mapView:l["default"].PropTypes.string,selectedSquareQuadkey:l["default"].PropTypes.string,pagination:l["default"].PropTypes.object,data:l["default"].PropTypes.object},mixins:[f["default"]],keybindings:{"arrow-left":function(){this.props.pagination.prevId&&this.prevResult(null)},"arrow-right":function(){this.props.pagination.nextId&&this.nextResult(null)}},getInitialState:function(){return{selectedPreview:"thumbnail"}},onPreviewSelect:function(e){var t=e.type;void 0!==e.index&&(t+="-"+e.index,t===this.state.selectedPreview&&(e={type:"none"},t="none")),v["default"].selectPreview(e),this.setState({selectedPreview:t})},prevResult:function(e){e&&e.preventDefault();var t=this.props,a=t.mapView,s=t.selectedSquareQuadkey,o=a+"/"+s+"/"+this.props.pagination.prevId;r.hashHistory.push({pathname:o,query:this.props.query})},viewAllResults:function(e){e&&e.preventDefault();var t=this.props,a=t.mapView,s=t.selectedSquareQuadkey,o=a+"/"+s;r.hashHistory.push({pathname:o,query:this.props.query})},nextResult:function(e){e&&e.preventDefault();var t=this.props,a=t.mapView,s=t.selectedSquareQuadkey,o=a+"/"+s+"/"+this.props.pagination.nextId;r.hashHistory.push({pathname:o,query:this.props.query})},onCopy:function(e,t){return this.refs["tms-drop-"+e].close(),this.refs["tms-url-"+e].value},onOpenJosm:function(e,t){this.refs["tms-drop-"+e].close();var a=this.props.data,s="OpenAerialMap - "+a.provider+" - "+a.uuid,r="https:"===document.location.protocol?"https://127.0.0.1:8112":"http://127.0.0.1:8111";m["default"].get(r+"/load_and_zoom?"+n["default"].stringify({left:a.bbox[0],right:a.bbox[2],bottom:a.bbox[1],top:a.bbox[3],source:s})).success(function(e){m["default"].get(r+"/imagery?"+n["default"].stringify({type:"tms",title:s})+"&url="+t).success(function(){v["default"].openModal("message",{title:"Success",message:l["default"].createElement("p",null,"This scene has been loaded into JOSM.")})})}).fail(function(e){console.error(e),v["default"].openModal("message",{title:"Error",message:l["default"].createElement("div",null,l["default"].createElement("p",null,"Could not connect to JOSM via Remote Control."),l["default"].createElement("p",null,"Is JOSM configured to allow ",l["default"].createElement("a",{href:"https://josm.openstreetmap.de/wiki/Help/Preferences/RemoteControl",target:"_blank"},"remote control"),"?"))})})},renderCopyWMTS:function(e){var t=this,a=this.props.data.properties.wmts;if(!a)return null;var s=function(){return t.refs["tms-drop-"+e].close(),a};return l["default"].createElement("ul",{className:"drop__menu drop__menu--iconified tms-options-menu",role:"menu"},l["default"].createElement("li",null,l["default"].createElement(w["default"],{onCopy:s,title:"Copy WMTS url",text:"Copy WMTS url"})))},renderTmsOptions:function(e,t,a,s,r){var o=this.props.data,i=(0,c["default"])(o.geojson).geometry.coordinates,u=this.props.mapView.split(",")[2],m="http://www.openstreetmap.org/edit?editor=id#map="+[u,i[1],i[0]].join("/")+"&"+n["default"].stringify({background:"custom:"+e}),d=this.state.selectedPreview==="tms-"+t?"button--active":"";return l["default"].createElement("div",{className:"form__group"},l["default"].createElement("label",{className:"form__label",htmlFor:"tms-url"},"TMS url"),l["default"].createElement("div",{className:"form__input-group"},l["default"].createElement("input",{className:"form__control form__control--medium",type:"text",value:e,readOnly:!0,ref:"tms-url-"+t}),l["default"].createElement("span",{className:"form__input-group-button"},l["default"].createElement(h.Dropdown,{className:"drop__content--tms-options",triggerElement:"button",triggerClassName:"button-tms-options",triggerActiveClassName:"button--active",triggerTitle:"Show options",triggerText:"Options",direction:a,alignment:s,ref:"tms-drop-"+t},l["default"].createElement("ul",{className:"drop__menu drop__menu--iconified tms-options-menu",role:"menu"},l["default"].createElement("li",null,l["default"].createElement("a",{className:"drop__menu-item ide",href:m,target:"_blank",title:"Open with iD editor"},"Open with iD editor")),l["default"].createElement("li",null,l["default"].createElement("a",{className:"drop__menu-item josm",onClick:this.onOpenJosm.bind(null,t,e),title:"Open with JOSM"},"Open with JOSM")),l["default"].createElement("li",null,l["default"].createElement(w["default"],{onCopy:this.onCopy.bind(null,t),title:"Copy TMS url",text:"Copy TMS url"}))),r&&this.renderCopyWMTS(t)))),l["default"].createElement("button",{className:"button--tms-preview "+d,type:"button",onClick:this.onPreviewSelect.bind(null,{type:"tms",index:t}),title:"Preview TMS on map"},l["default"].createElement("span",null,"preview")))},render:function(){var e=this.props.data,t=this.props.pagination,a=e.properties.tms?this.renderTmsOptions(e.properties.tms,"main","down","center",!0):null,s={backgroundImage:"url("+e.properties.thumbnail+")"},r=this.state.selectedPreview;return l["default"].createElement("article",{className:(e.properties.tms?"has-tms ":"")+"results-single"},l["default"].createElement("header",{className:"pane-header"},l["default"].createElement("h1",{className:"pane-title",title:e.title.replace(/\.[a-z]+$/,"")},e.title.replace(/\.[a-z]+$/,"")),l["default"].createElement("p",{className:"pane-subtitle"},t.current," of ",t.total," results")),l["default"].createElement("div",{className:"pane-body"},l["default"].createElement("div",{className:"pane-body-inner"},l["default"].createElement("div",{className:"single-media"},l["default"].createElement("div",{className:"blur-media",style:s}),l["default"].createElement("img",{alt:"Result thumbnail",src:e.properties.thumbnail||"assets/graphics/layout/img-placeholder.svg"})),l["default"].createElement("div",{className:"single-actions"},a,l["default"].createElement("a",{title:"Download image",className:"button-download",target:"_blank",href:e.uuid},l["default"].createElement("span",null,"Download")),l["default"].createElement("div",{className:"preview-options"},l["default"].createElement("h3",{className:"preview-options__title"},"Preview"),l["default"].createElement("div",{className:"button-group button-group--horizontal preview-options__buttons",role:"group"},l["default"].createElement("button",{className:"button button--small button--display "+("thumbnail"===r?"button--active":""),type:"button",onClick:this.onPreviewSelect.bind(null,{type:"thumbnail"})},l["default"].createElement("span",null,"Thumbnail")),e.properties.tms?l["default"].createElement("button",{className:"button button--small button--display "+("tms"===r?"button--active":""),type:"button",onClick:this.onPreviewSelect.bind(null,{type:"tms"})},l["default"].createElement("span",null,"TMS")):null,l["default"].createElement("button",{className:"button button--small button--display "+("none"===r?"button--active":""),type:"button",onClick:this.onPreviewSelect.bind(null,{type:"none"})},l["default"].createElement("span",null,"None"))))),l["default"].createElement("dl",{className:"single-details"},l["default"].createElement("dt",null,l["default"].createElement("span",null,"Date")),l["default"].createElement("dd",null,e.acquisition_start?e.acquisition_start.slice(0,10):"N/A"),l["default"].createElement("dt",null,l["default"].createElement("span",null,"Resolution")),l["default"].createElement("dd",null,k["default"].gsdToUnit(e.gsd)),l["default"].createElement("dt",null,l["default"].createElement("span",null,"Type")),l["default"].createElement("dd",null,e.properties.tms?"Image + Map Layer":"Image"),l["default"].createElement("dt",null,l["default"].createElement("span",null,"Image Size")),l["default"].createElement("dd",{className:"cap"},(0,g["default"])(e.file_size)),l["default"].createElement("dt",null,l["default"].createElement("span",null,"Platform")),l["default"].createElement("dd",{className:"cap"},e.platform),l["default"].createElement("dt",null,l["default"].createElement("span",null,"Sensor")),l["default"].createElement("dd",{className:"cap"},e.properties.sensor?e.properties.sensor:"not available"),l["default"].createElement("dt",null,l["default"].createElement("span",null,"Provider")),l["default"].createElement("dd",{className:"cap"},e.provider)),e.custom_tms?l["default"].createElement("section",{className:"single-related-tms"},l["default"].createElement("header",null,l["default"].createElement("h1",null,"Available map layers"),l["default"].createElement("p",null,"This image is part of the following map layers:")),l["default"].createElement("ul",null,e.custom_tms.map(function(e,t){return l["default"].createElement("li",{key:t},this.renderTmsOptions(e,t,"up","right"))}.bind(this)))):null)),l["default"].createElement("footer",{className:"pane-footer"},l["default"].createElement("ul",{className:"single-pager"},l["default"].createElement("li",{className:"view-all"},l["default"].createElement("a",{href:"#",onClick:this.viewAllResults,title:"View all results"},l["default"].createElement("span",null,"All"))),l["default"].createElement("li",{className:"view-prev"},l["default"].createElement("a",{href:"#",onClick:this.prevResult,className:this.props.pagination.prevId?"":"disabled",title:"View previous result"},l["default"].createElement("span",null,"Prev"))),l["default"].createElement("li",{className:"view-next"},l["default"].createElement("a",{href:"#",onClick:this.nextResult,className:this.props.pagination.nextId?"":"disabled",title:"View next result"},l["default"].createElement("span",null,"Next"))))))}});t.exports=S},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../utils/utils":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js","./shared/zc_button":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/shared/zc_button.js",jquery:"jquery","oam-design-system":"oam-design-system","pretty-bytes":"pretty-bytes",querystring:"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/index.js",react:"react","react-keybinding":"react-keybinding","react-router":"react-router","turf-centroid":"turf-centroid"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/results_list.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-router"),o=e("react"),l=s(o),i=e("../actions/actions"),n=s(i),u=e("../utils/utils"),m=s(u),d=l["default"].createClass({displayName:"ResultsListItem",propTypes:{query:l["default"].PropTypes.object,mapView:l["default"].PropTypes.string,selectedSquareQuadkey:l["default"].PropTypes.string,data:l["default"].PropTypes.object},onClick:function(e){e.preventDefault(),n["default"].resultOut(this.props.data);var t=this.props,a=t.mapView,s=t.selectedSquareQuadkey,o=a+"/"+s+"/"+this.props.data._id;r.hashHistory.push({pathname:o,query:this.props.query})},onOver:function(e){e.preventDefault(),n["default"].resultOver(this.props.data)},onOut:function(e){e.preventDefault(),n["default"].resultOut(this.props.data)},render:function(){var e=this.props.data;return l["default"].createElement("li",null,l["default"].createElement("article",{className:"card card-result-entry"},l["default"].createElement("a",{href:"#",onClick:this.onClick,onMouseOver:this.onOver,onMouseOut:this.onOut},l["default"].createElement("header",{className:"card-header"},l["default"].createElement("h1",{className:"card-title"},e.title),l["default"].createElement("div",{className:"card-media"},l["default"].createElement("img",{alt:"Result thumbnail",width:"768",height:"432",src:e.properties.thumbnail||"assets/graphics/layout/img-placeholder.svg"}))),l["default"].createElement("div",{className:"card-body"},l["default"].createElement("dl",{className:"card-details"},l["default"].createElement("dt",null,"Type"),l["default"].createElement("dd",null,e.properties.tms?"Image + Map Layer":"Image"),l["default"].createElement("dt",null,"Date"),l["default"].createElement("dd",null,e.acquisition_start?e.acquisition_start.slice(0,10):"N/A"),l["default"].createElement("dt",null,"Res"),l["default"].createElement("dd",null,m["default"].gsdToUnit(e.gsd)))))))}}),c=l["default"].createClass({displayName:"ResultsList",propTypes:{query:l["default"].PropTypes.object,mapView:l["default"].PropTypes.string,selectedSquareQuadkey:l["default"].PropTypes.string,results:l["default"].PropTypes.array},render:function(){var e=this,t=this.props.selectedSquareQuadkey,a=this.props.results.length,s=this.props.results.map(function(t){return l["default"].createElement(d,{key:t._id,query:e.props.query,mapView:e.props.mapView,selectedSquareQuadkey:e.props.selectedSquareQuadkey,data:t})});return l["default"].createElement("section",{className:"results-hub"},l["default"].createElement("header",{className:"pane-header"},l["default"].createElement("h1",{className:"pane-title",title:"Available imagery for square with quadKey "+t},"Available Imagery"),l["default"].createElement("p",{className:"pane-subtitle"},a," results")),l["default"].createElement("div",{className:"pane-body"},l["default"].createElement("div",{className:"pane-body-inner"},l["default"].createElement("ol",{className:"results-list"},s))),l["default"].createElement("footer",{className:"pane-footer"}))}});t.exports=c},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../utils/utils":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js",react:"react","react-router":"react-router"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/results_pane.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-router"),o=e("react"),l=s(o),i=e("react-keybinding"),n=s(i),u=e("lodash"),m=s(u),d=e("oam-design-system"),c=e("./results_list"),p=s(c),f=e("./results_item"),h=s(f),y=e("../actions/actions"),g=s(y),b=l["default"].createClass({displayName:"ResultsPane",propTypes:{query:l["default"].PropTypes.object,mapView:l["default"].PropTypes.string,results:l["default"].PropTypes.array,selectedItemId:l["default"].PropTypes.string,selectedSquareQuadkey:l["default"].PropTypes.string},mixins:[n["default"]],keybindings:{esc:function(){0!==this.props.results.length&&this.closeResults()}},feedbackClickHandler:function(e){e.preventDefault(),g["default"].openModal("feedback")},closeResults:function(e){e&&e.preventDefault(),r.hashHistory.push({pathname:this.props.mapView,query:this.props.query})},render:function(){var e=null;if(this.props.results.length&&this.props.selectedItemId){var t=m["default"].findIndex(this.props.results,{_id:this.props.selectedItemId}),a={total:this.props.results.length,current:t+1,prevId:t>0?this.props.results[t-1]._id:null,nextId:t<this.props.results.length-1?this.props.results[t+1]._id:null};e=l["default"].createElement(h["default"],{query:this.props.query,mapView:this.props.mapView,selectedSquareQuadkey:this.props.selectedSquareQuadkey,data:this.props.results[t],pagination:a})}else{if(!this.props.results.length||!this.props.selectedSquareQuadkey)return null;e=l["default"].createElement(p["default"],{query:this.props.query,mapView:this.props.mapView,selectedSquareQuadkey:this.props.selectedSquareQuadkey,results:this.props.results})}return l["default"].createElement("div",{id:"results-pane",className:"pane"},l["default"].createElement("a",{href:"",onClick:this.closeResults,className:"pane-dismiss",title:"Exit selection"},l["default"].createElement("span",null,"Close")),l["default"].createElement(d.Dropdown,{triggerElement:"a",triggerClassName:"pane-more",triggerActiveClassName:"button--active",triggerTitle:"More options",triggerText:"More options",direction:"down",alignment:"right"},l["default"].createElement("ul",{className:"drop__menu info-menu",role:"menu"},l["default"].createElement("li",null,l["default"].createElement("a",{className:"drop__menu-item",href:"https://twitter.com/share?url="+encodeURIComponent(window.location.href),target:"_blank",title:"Share on twitter","data-hook":"dropdown:close"},l["default"].createElement("span",null,"Share on Twitter"))),l["default"].createElement("li",null,l["default"].createElement("a",{className:"drop__menu-item",href:"http://facebook.com/sharer.php?u="+encodeURIComponent(window.location.href),target:"_blank",title:"Share on Facebook","data-hook":"dropdown:close"},l["default"].createElement("span",null,"Share on Facebook")))),l["default"].createElement("ul",{className:"drop__menu info-menu",role:"menu"},l["default"].createElement("li",null,l["default"].createElement("a",{className:"drop__menu-item",title:"Report a problem","data-hook":"dropdown:close",onClick:this.feedbackClickHandler},l["default"].createElement("span",null,"Report a problem"))))),e)}});t.exports=b},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","./results_item":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/results_item.js","./results_list":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/results_list.js",lodash:"lodash","oam-design-system":"oam-design-system",react:"react","react-keybinding":"react-keybinding","react-router":"react-router"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/shared/zc_button.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("clipboard"),i=s(l),n=o["default"].createClass({displayName:"ZcButton",propTypes:{onCopy:o["default"].PropTypes.func.isRequired,className:o["default"].PropTypes.string,title:o["default"].PropTypes.string,text:o["default"].PropTypes.string},clipboard:null,getDefaultProps:function(){return{title:"",className:"drop__menu-item clipboard",text:""}},componentDidMount:function(){var e=this;this.clipboard=new i["default"](this.refs.el,{text:function(t){return e.props.onCopy(t)}})},componentWillUnmount:function(){this.clipboard.destroy()},onCopyClick:function(e){e.preventDefault()},render:function(){return o["default"].createElement("a",{ref:"el",href:"#",title:this.props.title,className:this.props.className,onClick:this.onCopyClick},o["default"].createElement("span",null,this.props.text))}});t.exports=n},{clipboard:"clipboard",react:"react"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js":[function(e,t,a){"use strict";var s=e("lodash"),r={local:e("./config/local.js"),production:e("./config/production.js"),staging:e("./config/staging.js")},o=r.local||{};(0,s.defaultsDeep)(o,r.production),t.exports=o},{"./config/local.js":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config/local.js","./config/production.js":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config/production.js","./config/staging.js":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config/staging.js",lodash:"lodash"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config/local.js":[function(e,t,a){"use strict";t.exports={environment:"development"}},{}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config/production.js":[function(e,t,a){"use strict";t.exports={environment:"production",map:{mapbox:{accessToken:"pk.eyJ1Ijoib3BlbmFlcmlhbG1hcCIsImEiOiJjaXl4MjM5c20wMDBmMzNucnZtbnYwZTcxIn0.IKG5flWCS6QfpO3iOdRveg"},initialZoom:3,minZoom:2,maxZoom:void 0,initialView:[-18.632,18.479]},catalog:{url:"https://api.openaerialmap.org"},oamStatus:"https://status.openaerialmap.org/healthcheck"}},{}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config/staging.js":[function(e,t,a){"use strict";t.exports={environment:"staging",catalog:{url:"https://oam-catalog-staging.herokuapp.com"}}},{}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/main.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react-dom"),o=e("./routes"),l=s(o);(0,r.render)(l["default"],document.getElementById("page-canvas"))},{"./routes":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/routes.js","react-dom":"react-dom"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/routes.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("react"),o=s(r),l=e("react-router"),i=e("./components/app"),n=s(i),u=e("./components/home"),m=s(u),d=o["default"].createElement(l.Router,{history:l.hashHistory},o["default"].createElement(l.Route,{path:"/",component:n["default"]},o["default"].createElement(l.IndexRoute,{component:m["default"]}),o["default"].createElement(l.Route,{name:"map",path:"/:map",component:m["default"]},o["default"].createElement(l.Route,{name:"results",path:":square",component:m["default"]},o["default"].createElement(l.Route,{name:"item",path:":item_id",component:m["default"]})))));t.exports=d},{"./components/app":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/app.js","./components/home":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/components/home.js",react:"react","react-router":"react-router"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/map_store.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("querystring"),o=s(r),l=e("reflux"),i=s(l),n=e("lodash"),u=s(n),m=e("jquery"),d=s(m),c=e("turf-extent"),p=s(c),f=e("rbush"),h=s(f),y=e("../actions/actions"),g=s(y),b=e("./search_query_store"),v=s(b),_=e("../config"),w=s(_),E=e("../utils/map-layers"),k=s(E);t.exports=i["default"].createStore({storage:{prevSearchParams:"",results:[],sqrSelected:null,latestImagery:null,footprintsTree:null,baseLayer:k["default"][0]},init:function(){this.listenTo(g["default"].selectedBbox,this.onSelectedBbox),this.listenTo(g["default"].setBaseLayer,this.onSetBaseLayer),this.queryLatestImagery(),this.queryFootprints()},onSetBaseLayer:function(e){this.storage.baseLayer=e},queryLatestImagery:function(){var e=this;d["default"].get(w["default"].catalog.url+"/meta?order_by=acquisition_end&sort=desc&limit=1").success(function(t){e.storage.latestImagery=t.results[0],g["default"].latestImageryLoaded()})},queryFootprints:function(){var e=this;d["default"].get(w["default"].catalog.url+"/meta?limit=99999").success(function(t){var a=e.parseFootprints(t.results),s=(0,h["default"])(9);s.load(a.features.map(function(e){var t=e.geometry.bbox;return t.feature=e,t})),e.storage.footprintsTree=s,e.trigger("footprints")})},parseFootprints:function(e){var t={type:"FeatureCollection",features:[]},a=0;return u["default"].each(e,function(e){t.features.push({type:"Feature",properties:{gsd:e.gsd,tms:!!e.properties.tms||!!e.custom_tms,acquisition_end:e.acquisition_end,FID:a++},geometry:e.geojson})}),t},getFootprintsInSquare:function(e){return this.storage.footprintsTree?this.storage.footprintsTree.search((0,p["default"])(e)):[]},footprintsWereFecthed:function(){return null===this.storage.footprintsTree},queryData:function(){var e=v["default"].getParameters(),t=this,a={all:{},low:{gsd_from:5},medium:{gsd_from:1,gsd_to:5},high:{gsd_to:1}}[e.resolution],s=new Date;"week"===e.date?s.setDate(s.getDate()-7):"month"===e.date?s.setMonth(s.getMonth()-1):"year"===e.date&&s.setFullYear(s.getFullYear()-1);var r="all"===e.date?{}:{acquisition_from:[s.getFullYear(),s.getMonth()+1,s.getDate()].join("-")},l="all"===e.dataType?{}:{has_tiled:!0},i=this.storage.selectedBbox.join(","),n=u["default"].assign({limit:4e3,bbox:i},a,r,l),m=o["default"].stringify(n);return m===this.storage.prevSearchParams?void t.trigger("squareData"):(this.storage.prevSearchParams=m,
void d["default"].get(w["default"].catalog.url+"/meta?"+m).success(function(e){t.storage.results=e.results,t.trigger("squareData")}))},onSelectedBbox:function(e){this.storage.selectedBbox=e,this.queryData()},getLatestImagery:function(){return this.storage.latestImagery},getResults:function(){return this.storage.results},getBaseLayer:function(){return this.storage.baseLayer}})},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js","../config":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js","../utils/map-layers":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/map-layers.js","./search_query_store":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/search_query_store.js",jquery:"jquery",lodash:"lodash",querystring:"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/index.js",rbush:"rbush",reflux:"reflux","turf-extent":"turf-extent"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/stores/search_query_store.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("reflux"),o=s(r),l=e("lodash"),i=s(l),n=e("../actions/actions"),u=s(n);t.exports=o["default"].createStore({_parameters:{date:"all",resolution:"all",dataType:"all"},init:function(){this.listenTo(u["default"].setDateFilter,this.onSetDateFilter),this.listenTo(u["default"].setResolutionFilter,this.onSetResolutionFilter),this.listenTo(u["default"].setDataTypeFilter,this.onSetDataTypeFilter)},onSetDateFilter:function(e){this._setParameter({date:e})},onSetResolutionFilter:function(e){this._setParameter({resolution:e})},onSetDataTypeFilter:function(e){this._setParameter({dataType:e})},_setParameter:function(e){i["default"].assign(this._parameters,e);for(var t in this._parameters)null===this._parameters[t]&&delete this._parameters[t];this.trigger(this._parameters,Object.keys(e)[0])},getParameters:function(){return this._parameters}})},{"../actions/actions":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/actions/actions.js",lodash:"lodash",reflux:"reflux"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/cookie.js":[function(e,t,a){"use strict";t.exports.create=function(e,t,a,s){s=s||"/";var r="";if(a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3),r="; expires="+o.toGMTString()}document.cookie=e+"="+t+r+"; path="+s},t.exports.read=function(e){for(var t=e+"=",a=document.cookie.split(";"),s=0;s<a.length;s++){for(var r=a[s];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null},t.exports.erase=function(e,a){a=a||"/",t.exports.createCookie(e,"",-1,a)}},{}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/ds_zoom.js":[function(e,t,a){"use strict";e("mapbox.js");var s=L.Control.extend({options:{position:"topleft",containerClasses:"",zoomInClasses:"",zoomOutClasses:"",zoomInText:"<span>Zoom in</span>",zoomOutText:"<span>Zoom out</span>"},onAdd:function(e){var t=this.options,a=L.DomUtil.create("div",t.containerClasses);return this._zoomInButton=this._createButton(t.zoomInText,t.zoomInClasses,a,this._zoomIn),this._zoomOutButton=this._createButton(t.zoomOutText,t.zoomOutClasses,a,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),a},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){this._disabled||this._map.zoomIn(e.shiftKey?3:1)},_zoomOut:function(e){this._disabled||this._map.zoomOut(e.shiftKey?3:1)},_createButton:function(e,t,a,s){var r=L.DomUtil.create("button",t,a);return r.innerHTML=e,L.DomEvent.on(r,"mousedown dblclick",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.stop).on(r,"click",s,this).on(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var e=this._map,t="disabled";L.DomUtil.removeClass(this._zoomInButton,t),L.DomUtil.removeClass(this._zoomOutButton,t),(this._disabled||e._zoom===e.getMinZoom())&&L.DomUtil.addClass(this._zoomOutButton,t),(this._disabled||e._zoom===e.getMaxZoom())&&L.DomUtil.addClass(this._zoomInButton,t)}});t.exports=s},{"mapbox.js":"mapbox.js"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/map-layers.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var r=e("../config"),o=s(r);t.exports=[{id:"oam-base",name:"Mapbox Light",url:"https://api.mapbox.com/styles/v1/openaerialmap/ciyx269by002w2rldex1768f5/tiles/256/{z}/{x}/{y}?access_token="+o["default"].map.mapbox.accessToken},{id:"osm",name:"OpenStreetMap (Standard)",url:"http://a.tile.openstreetmap.org/{z}/{x}/{y}.png"},{id:"satellite",name:"Mapbox Satellite",url:"https://api.mapbox.com/styles/v1/openaerialmap/ciyx28hy800362rto0u9x10fv/tiles/256/{z}/{x}/{y}?access_token="+o["default"].map.mapbox.accessToken}]},{"../config":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js"}],"/home/travis/build/hotosm/oam-browser/app/assets/scripts/utils/utils.js":[function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function r(e){for(e=[e[0],e[1]];e[0]<-180;)e[0]+=360;for(;e[0]>=180;)e[0]-=360;return e}var o=e("turf-centroid"),l=s(o),i=e("turf-extent"),n=s(i),u=e("tilebelt"),m=s(u),d=e("../config"),c=s(d),p=e("jquery"),f=s(p);t.exports.strToCoods=function(e){if(!e)return null;var t=new RegExp("^(-?[0-9]{1,2}.[0-9]+),(-?[0-9]{1,2}.[0-9]+)$"),a=e.match(t);return!a||a[1]>180||a[1]<-180||a[2]>90||a[2]<-90?null:[parseFloat(a[1]),parseFloat(a[2])]},t.exports.getPolygonFeature=function(e){return{type:"Feature",geometry:{type:"Polygon",coordinates:e}}},t.exports.gsdToUnit=function(e){var t="m";return e<1&&(t="cm",e*=100),Math.round(e)+" "+t},t.exports.quadkeyFromCoords=function(e,t,a){var s=m["default"].pointToTile(e,t,a+3);return m["default"].tileToQuadkey(s)},t.exports.coordsFromQuadkey=function(e){var t=m["default"].quadkeyToTile(e),a=m["default"].tileToGeoJSON(t);return a.coordinates},t.exports.tileCenterFromCoords=function(e,t,a){var s=m["default"].pointToTile(e,t,a+3),r=m["default"].tileToGeoJSON(s),o=(0,l["default"])(r);return[o.geometry.coordinates[0],o.geometry.coordinates[1]]},t.exports.tileCenterFromQuadkey=function(e){var t=m["default"].quadkeyToTile(e),a=m["default"].tileToGeoJSON(t);return(0,l["default"])(a)},t.exports.tileBboxFromQuadkey=function(e){var t=m["default"].quadkeyToTile(e),a=m["default"].tileToGeoJSON(t);return(0,n["default"])({type:"Feature",geometry:a})},t.exports.queryGeocoder=function(e,t,a){var s="https://api.tiles.mapbox.com/geocoding/v5/mapbox.places/"+encodeURIComponent(e)+".json?access_token="+c["default"].map.mapbox.accessToken,r=f["default"].get(s);return t&&(r=r.success(function(e){var a=!1;e.features.length&&(a=[[e.features[0].bbox[1],e.features[0].bbox[0]],[e.features[0].bbox[3],e.features[0].bbox[2]]]),t(a,e)})),a&&(r=r.error(a)),r},t.exports.getMapViewString=function(e,t,a){return[e,t,a].join(",")},t.exports.wrap=function(e){return{type:e.type,properties:e.properties,geometry:{type:e.geometry.type,coordinates:[e.geometry.coordinates[0].map(r)]}}}},{"../config":"/home/travis/build/hotosm/oam-browser/app/assets/scripts/config.js",jquery:"jquery",tilebelt:"tilebelt","turf-centroid":"turf-centroid","turf-extent":"turf-extent"}],"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/decode.js":[function(e,t,a){"use strict";function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.exports=function(e,t,a,o){t=t||"&",a=a||"=";var l={};if("string"!=typeof e||0===e.length)return l;var i=/\+/g;e=e.split(t);var n=1e3;o&&"number"==typeof o.maxKeys&&(n=o.maxKeys);var u=e.length;n>0&&u>n&&(u=n);for(var m=0;m<u;++m){var d,c,p,f,h=e[m].replace(i,"%20"),y=h.indexOf(a);y>=0?(d=h.substr(0,y),c=h.substr(y+1)):(d=h,c=""),p=decodeURIComponent(d),f=decodeURIComponent(c),s(l,p)?r(l[p])?l[p].push(f):l[p]=[l[p],f]:l[p]=f}return l};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},{}],"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/encode.js":[function(e,t,a){"use strict";function s(e,t){if(e.map)return e.map(t);for(var a=[],s=0;s<e.length;s++)a.push(t(e[s],s));return a}var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};t.exports=function(e,t,a,i){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?s(l(e),function(l){var i=encodeURIComponent(r(l))+a;return o(e[l])?s(e[l],function(e){return i+encodeURIComponent(r(e))}).join(t):i+encodeURIComponent(r(e[l]))}).join(t):i?encodeURIComponent(r(i))+a+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t}},{}],"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/index.js":[function(e,t,a){"use strict";a.decode=a.parse=e("./decode"),a.encode=a.stringify=e("./encode")},{"./decode":"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/decode.js","./encode":"/home/travis/build/hotosm/oam-browser/node_modules/browserify/node_modules/querystring-es3/encode.js"}]},{},["/home/travis/build/hotosm/oam-browser/app/assets/scripts/main.js"]);